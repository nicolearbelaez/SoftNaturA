{% load static %}
{% block styles %}
<link rel="stylesheet" href="{% static 'usuarios/css/mis_pedidos-gst_pedidos-ventas.css' %}" />
{% endblock %}

{% block content %}


<div class="contenedor-pedidos">
    <h2>Mis Pedidos</h2>
    
    {% if pedidos %}
        {% for pedido in pedidos %}
            {% if pedido.items.all %}
            <div class="pedido-card">
                <!-- Información del pedido -->
                <div class="pedido-header">
                    <div class="info-item">
                        <span class="info-label">Número de Pedido</span>
                        <span class="info-value">#{{ pedido.id }}</span>
                    </div>
                    
                    <div class="info-item">
                        <span class="info-label">Order ID</span>
                        <span class="info-value">{{ pedido.order_id|default:"N/A" }}</span>
                    </div>
                    
                    <div class="info-item">
                        <span class="info-label">Fecha</span>
                        <span class="info-value">{{ pedido.fecha_creacion|date:"d/m/Y H:i" }}</span>
                    </div>
                    
                    <div class="info-item">
                        <span class="info-label">Estado de Domicilio</span>
                        <span class="estado estado-{{ pedido.estado }}">
                            {% if pedido.estado == 'pendiente' %} Pendiente
                            {% elif pedido.estado == 'enviado' %} Enviado
                            {% elif pedido.estado == 'entregado' %} Entregado
                            {% else %}{{ pedido.estado }}
                            {% endif %}
                        </span>
                    </div>
                    
                    <div class="info-item">
                        <span class="info-label">Estado de Pago</span>
                        <span class="estado {% if pedido.pago %}estado-pagado{% else %}estado-pendiente{% endif %}">
                            {% if pedido.pago %}
                                 Pagado
                            {% else %}
                                 No Pagado
                            {% endif %}
                        </span>
                    </div>
                </div>
                
                <!-- Productos -->
                <div class="productos-section">
                    <h4> Productos:</h4>
                    
                    {% for item in pedido.items.all %}
                    <div class="producto-item">
                        <div class="producto-info">
                            <div class="producto-nombre">{{ item.producto.nombProduc }}</div>
                            <div class="producto-cantidad">Cantidad: {{ item.cantidad }}</div>
                        </div>
                        <div class="producto-precio">
                            ${{ item.producto.precio|floatformat:0 }}
                        </div>
                    </div>
                    {% endfor %}
                    
                    <!-- Total del pedido -->
                    <div class="total-pedido">
                        <span class="total-label">Total Pagado:</span>
                        <span class="total-value">${{ pedido.total|floatformat:0 }}</span>
                    </div>
                </div>
            </div>
            {% endif %}
        {% empty %}
        <p class="no-pedidos"> No tienes pedidos con productos todavía.</p>
        {% endfor %}
    {% else %}
        <p class="no-pedidos">No has hecho ningún pedido todavía.</p>
    {% endif %}
    
    <div class="centrado">
        <a href="{% url 'productos:producto' %}" class="btn-volver">← Volver a la tienda</a>
    </div>
</div>
{% endblock %}